language:
  - c
install:
  - sudo apt-get update
  - sudo apt-get install linuxdoc-tools linuxdoc-tools-info binutils-mingw-w64-i686 gcc-mingw-w64-i686 sshpass cmake
  - if [ "${PYTHON:0:1}" = "3" ]; then export PY=3; fi
  - pip$PY install --upgrade pip setuptools wheel
  - pip$PY install --only-binary=numpy,scipy numpy scipy
  - pip$PY install -r requirements.txt
  - pip$PY install pytest-cov
  - pip$PY install coveralls
  - CC=g++-7 pip$PY install revkit
  - if [ "${PYTHON:0:1}" = "3" ]; then pip$PY install dormouse; fi
script:
  - mkdir _build && cd _build && cmake -DUSE_OPENCL=OFF -DENABLE_COMPLEX8=OFF .. && make -j 8 all
  - cd .. && rm -r _build
  - mkdir _build && cd _build && cmake -DUSE_OPENCL=OFF -DENABLE_COMPLEX8=ON .. && make -j 8 all
  - ./unittest --proc-cpu
  - cd .. && git clone https://github.com/vm6502q/ProjectQ.git && cd ProjectQ
  - pip$PY install -e . --global-option="--with-qracksimulator"
  - cd build && export OMP_NUM_THREADS=1 && pytest projectq --cov projectq
